

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>lightkurve.periodogram &mdash; lightkurve 1.0b21 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> lightkurve
          

          
            
            <img src="../../_static/lightkurve.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.0b21
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API documentation</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/section1.html">Introduction to lightkurve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/section2.html">Science with lightkurve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/section3.html">Extracting lightcurves</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/section4.html">Systematics correction</a></li>
</ul>
<p class="caption"><span class="caption-text">About lightkurve</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing and reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer.html">Developer documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../citing.html">Citing and acknowledging lightkurve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../other_software.html">Other software</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">lightkurve</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>lightkurve.periodogram</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for lightkurve.periodogram</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Defines the Periodogram class and associated tools.&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>

<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="kn">import</span> <span class="nn">astropy</span>
<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="k">import</span> <span class="n">Table</span>
<span class="kn">from</span> <span class="nn">astropy.stats</span> <span class="k">import</span> <span class="n">LombScargle</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="k">import</span> <span class="n">__version__</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="k">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">from</span> <span class="nn">astropy.units</span> <span class="k">import</span> <span class="n">cds</span>
<span class="kn">from</span> <span class="nn">astropy.convolution</span> <span class="k">import</span> <span class="n">convolve</span><span class="p">,</span> <span class="n">Box1DKernel</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">MPLSTYLE</span>

<span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Periodogram&#39;</span><span class="p">]</span>


<div class="viewcode-block" id="Periodogram"><a class="viewcode-back" href="../../api/lightkurve.periodogram.Periodogram.html#lightkurve.periodogram.Periodogram">[docs]</a><span class="k">class</span> <span class="nc">Periodogram</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class to represents a power spectrum, i.e. frequency vs power.</span>

<span class="sd">    The Periodogram class represents a power spectrum, with values of</span>
<span class="sd">    frequency on the x-axis (in any frequency units) and values of power on the</span>
<span class="sd">    y-axis (in units of ppm^2 / [frequency units]).</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    frequency : `astropy.units.Quantity` object</span>
<span class="sd">        Array of frequencies with associated astropy unit.</span>
<span class="sd">    power : `astropy.units.Quantity` object</span>
<span class="sd">        Array of power-spectral-densities. The Quantity array must have units</span>
<span class="sd">        of `ppm^2 / freq_unit`, where freq_unit is the unit of the frequency</span>
<span class="sd">        attribute.</span>
<span class="sd">    nyquist : float, optional</span>
<span class="sd">        The Nyquist frequency of the lightcurve. In units of freq_unit, where</span>
<span class="sd">        freq_unit is the unit of the frequency attribute.</span>
<span class="sd">    targetid : str, optional</span>
<span class="sd">        Identifier of the target.</span>
<span class="sd">    label : str, optional</span>
<span class="sd">        Human-friendly object label, e.g. &quot;KIC 123456789&quot;.</span>
<span class="sd">    meta : dict, optional</span>
<span class="sd">        Free-form metadata associated with the Periodogram.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frequency</span><span class="p">,</span> <span class="n">power</span><span class="p">,</span> <span class="n">nyquist</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">targetid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">meta</span><span class="o">=</span><span class="p">{}):</span>
        <span class="c1"># Input validation</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frequency</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">Quantity</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;frequency must be an `astropy.units.Quantity` object.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">power</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">Quantity</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;power must be an `astropy.units.Quantity` object.&#39;</span><span class="p">)</span>
        <span class="c1"># Frequency must have frequency units</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">frequency</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">Hz</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">u</span><span class="o">.</span><span class="n">UnitConversionError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Frequency must be in units of 1/time.&#39;</span><span class="p">)</span>
        <span class="c1"># Frequency and power must have sensible shapes</span>
        <span class="k">if</span> <span class="n">frequency</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;frequency and power must have a length greater than 1.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">frequency</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">power</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;frequency and power must have the same length.&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">frequency</span> <span class="o">=</span> <span class="n">frequency</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">power</span> <span class="o">=</span> <span class="n">power</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nyquist</span> <span class="o">=</span> <span class="n">nyquist</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">targetid</span> <span class="o">=</span> <span class="n">targetid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span> <span class="o">=</span> <span class="n">meta</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">period</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the array of periods, i.e. 1/frequency.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">1.</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequency</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">max_power</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the power of the highest peak in the periodogram.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">frequency_at_max_power</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the frequency corresponding to the highest peak in the periodogram.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequency</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nanargmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="p">)]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">period_at_max_power</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the period corresponding to the highest peak in the periodogram.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">1.</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequency_at_max_power</span>

<div class="viewcode-block" id="Periodogram.from_lightcurve"><a class="viewcode-back" href="../../api/lightkurve.periodogram.Periodogram.html#lightkurve.periodogram.Periodogram.from_lightcurve">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">from_lightcurve</span><span class="p">(</span><span class="n">lc</span><span class="p">,</span> <span class="n">min_frequency</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_frequency</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">min_period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">frequency</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">nterms</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nyquist_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">oversample_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                        <span class="n">freq_unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a Periodogram from a LightCurve using the Lomb-Scargle method.</span>

<span class="sd">        By default, the periodogram will be created for a regular grid of</span>
<span class="sd">        frequencies from one frequency separation to the Nyquist frequency,</span>
<span class="sd">        where the frequency separation is determined as 1 / the time baseline.</span>

<span class="sd">        The min frequency and/or max frequency (or max period and/or min period)</span>
<span class="sd">        can be passed to set custom limits for the frequency grid. Alternatively,</span>
<span class="sd">        the user can provide a custom regular grid using the `frequency`</span>
<span class="sd">        parameter or a custom regular grid of periods using the `period`</span>
<span class="sd">        parameter.</span>

<span class="sd">        The spectrum can be oversampled by increasing the oversample_factor</span>
<span class="sd">        parameter. The parameter nterms controls how many Fourier terms are used</span>
<span class="sd">        in the model. Note that many terms could lead to spurious peaks. Setting</span>
<span class="sd">        the Nyquist_factor to be greater than 1 will sample the space beyond the</span>
<span class="sd">        Nyquist frequency, which may introduce aliasing.</span>

<span class="sd">        The unit parameter allows a request for alternative units in frequency</span>
<span class="sd">        space. By default frequency is in (1/day) and power in (ppm^2 * day).</span>
<span class="sd">        Asteroseismologists for example may want frequency in (microHz) and</span>
<span class="sd">        power in (ppm^2 / microHz), in which case they would pass</span>
<span class="sd">        `unit = u.microhertz` where `u` is `astropy.units`</span>

<span class="sd">        By default this method uses the LombScargle &#39;fast&#39; method, which assumes</span>
<span class="sd">        a regular grid. If a regular grid of periods (i.e. an irregular grid of</span>
<span class="sd">        frequencies) it will use the &#39;slow&#39; method. If nterms &gt; 1 is passed, it</span>
<span class="sd">        will use the &#39;fastchi2&#39; method for regular grids, and &#39;chi2&#39; for</span>
<span class="sd">        irregular grids. The normalizatin of the Lomb Scargle periodogram is</span>
<span class="sd">        fixed to `psd`, and cannot be overridden.</span>

<span class="sd">        Caution: this method assumes that the LightCurve&#39;s time (lc.time)</span>
<span class="sd">        is given in units of days.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        lc : LightCurve object</span>
<span class="sd">            The LightCurve from which to compute the Periodogram.</span>
<span class="sd">        min_frequency : float</span>
<span class="sd">            If specified, use this minimum frequency rather than one over the</span>
<span class="sd">            time baseline.</span>
<span class="sd">        max_frequency : float</span>
<span class="sd">            If specified, use this maximum frequency rather than nyquist_factor</span>
<span class="sd">            times the nyquist frequency.</span>
<span class="sd">        min_period : float</span>
<span class="sd">            If specified, use 1./minium_period as the maximum frequency rather</span>
<span class="sd">            than nyquist_factor times the nyquist frequency.</span>
<span class="sd">        max_period : float</span>
<span class="sd">            If specified, use 1./maximum_period as the minimum frequency rather</span>
<span class="sd">            than one over the time baseline.</span>
<span class="sd">        frequency :  array-like</span>
<span class="sd">            The regular grid of frequencies to use. If given a unit, it is</span>
<span class="sd">            converted to units of freq_unit. If not, it is assumed to be in</span>
<span class="sd">            units of freq_unit. This over rides any set frequency limits.</span>
<span class="sd">        period : array-like</span>
<span class="sd">            The regular grid of periods to use (as 1/period). If given a unit,</span>
<span class="sd">            it is converted to units of freq_unit. If not, it is assumed to be</span>
<span class="sd">            in units of 1/freq_unit. This overrides any set period limits.</span>
<span class="sd">        nterms : int</span>
<span class="sd">            Default 1. Number of terms to use in the Fourier fit.</span>
<span class="sd">        nyquist_factor : int</span>
<span class="sd">            Default 1. The multiple of the average Nyquist frequency. Is</span>
<span class="sd">            overriden by maximum_frequency (or minimum period).</span>
<span class="sd">        oversample_factor : int</span>
<span class="sd">            The frequency spacing, determined by the time baseline of the</span>
<span class="sd">            lightcurve, is divided by this factor, oversampling the frequency</span>
<span class="sd">            space. This parameter is identical to the samples_per_peak parameter</span>
<span class="sd">            in astropy.LombScargle()</span>
<span class="sd">        freq_unit : `astropy.units.core.CompositeUnit`</span>
<span class="sd">            Default: 1/u.day. The desired frequency units for the Lomb Scargle</span>
<span class="sd">            periodogram. This implies that 1/freq_unit is the units for period.</span>
<span class="sd">        kwargs : dict</span>
<span class="sd">            Keyword arguments passed to `astropy.stats.LombScargle()`</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Periodogram : `Periodogram` object</span>
<span class="sd">            Returns a Periodogram object extracted from the lightcurve.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Make sure the lightcurve object is normalized</span>
        <span class="n">lc</span> <span class="o">=</span> <span class="n">lc</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>

        <span class="c1"># Check if any values of period have been passed and set format accordingly</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">b</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="p">[</span><span class="n">period</span><span class="p">,</span> <span class="n">min_period</span><span class="p">,</span> <span class="n">max_period</span><span class="p">]):</span>
            <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;period&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;frequency&#39;</span>

        <span class="c1"># If period and frequency keywords have both been set, throw an error</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">b</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="p">[</span><span class="n">period</span><span class="p">,</span> <span class="n">min_period</span><span class="p">,</span> <span class="n">max_period</span><span class="p">]))</span> <span class="o">&amp;</span> \
           <span class="p">(</span><span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">b</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="p">[</span><span class="n">frequency</span><span class="p">,</span> <span class="n">min_frequency</span><span class="p">,</span> <span class="n">max_frequency</span><span class="p">])):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;You have input keyword arguments for both frequency and period. &#39;</span>
                             <span class="s1">&#39;Please only use one.&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">lc</span><span class="o">.</span><span class="n">flux</span><span class="p">))</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Lightcurve contains NaN values. Use lc.remove_nans()&#39;</span>
                             <span class="s1">&#39; to remove NaN values from a LightCurve.&#39;</span><span class="p">)</span>

        <span class="c1"># Hard coding that time is in days.</span>
        <span class="n">time</span> <span class="o">=</span> <span class="n">lc</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">day</span>

        <span class="c1"># Calculate Nyquist Frequency and frequency bin width in terms of days</span>
        <span class="n">nyquist</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">time</span><span class="p">))))</span>
        <span class="n">fs</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">/</span> <span class="n">oversample_factor</span>

        <span class="c1"># Convert these values to requested frequency unit</span>
        <span class="n">nyquist</span> <span class="o">=</span> <span class="n">nyquist</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">freq_unit</span><span class="p">)</span>
        <span class="n">fs</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">freq_unit</span><span class="p">)</span>

        <span class="c1"># Warn if there is confusing input</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">frequency</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="nb">any</span><span class="p">([</span><span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="n">min_frequency</span><span class="p">,</span> <span class="n">max_frequency</span><span class="p">]])):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;You have passed both a grid of frequencies &quot;</span>
                        <span class="s2">&quot;and min_frequency/max_frequency arguments; &quot;</span>
                        <span class="s2">&quot;the latter will be ignored.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">period</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="nb">any</span><span class="p">([</span><span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="n">min_period</span><span class="p">,</span> <span class="n">max_period</span><span class="p">]])):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;You have passed a grid of periods &quot;</span>
                        <span class="s2">&quot;and min_period/max_period arguments; &quot;</span>
                        <span class="s2">&quot;the latter will be ignored.&quot;</span><span class="p">)</span>

        <span class="c1"># Tidy up the period stuff...</span>
        <span class="k">if</span> <span class="n">max_period</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># min_frequency MUST be none by this point.</span>
            <span class="n">min_frequency</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">max_period</span>
        <span class="k">if</span> <span class="n">min_period</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># max_frequency MUST be none by this point.</span>
            <span class="n">max_frequency</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">min_period</span>
        <span class="c1"># If the user specified a period, copy it into the frequency.</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">period</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">frequency</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">period</span>

        <span class="c1"># Do unit conversions if user input min/max frequency or period</span>
        <span class="k">if</span> <span class="n">frequency</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">min_frequency</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">min_frequency</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">min_frequency</span><span class="p">,</span> <span class="n">freq_unit</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">max_frequency</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">max_frequency</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">max_frequency</span><span class="p">,</span> <span class="n">freq_unit</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">min_frequency</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">max_frequency</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">min_frequency</span> <span class="o">&gt;</span> <span class="n">max_frequency</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">format</span> <span class="o">==</span> <span class="s1">&#39;frequency&#39;</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;min_frequency cannot be larger than max_frequency&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">format</span> <span class="o">==</span> <span class="s1">&#39;period&#39;</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;min_period cannot be larger than max_period&#39;</span><span class="p">)</span>
            <span class="c1"># If nothing has been passed in, set them to the defaults</span>
            <span class="k">if</span> <span class="n">min_frequency</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">min_frequency</span> <span class="o">=</span> <span class="n">fs</span>
            <span class="k">if</span> <span class="n">max_frequency</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">max_frequency</span> <span class="o">=</span> <span class="n">nyquist</span> <span class="o">*</span> <span class="n">nyquist_factor</span>

            <span class="c1"># Create frequency grid evenly spaced in frequency</span>
            <span class="n">frequency</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">min_frequency</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">max_frequency</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">fs</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">freq_unit</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

        <span class="c1"># Convert to desired units</span>
        <span class="n">frequency</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">frequency</span><span class="p">,</span> <span class="n">freq_unit</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">nterms</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Increasing the number of terms is not implemented yet.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;fast&#39;</span>

        <span class="k">if</span> <span class="n">period</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;slow&#39;</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;You have passed an evenly-spaced grid of periods. &quot;</span>
                        <span class="s2">&quot;These are not evenly spaced in frequency space.</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="s2">&quot;Method has been set to &#39;slow&#39; to allow for this.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">__version__</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">LS</span> <span class="o">=</span> <span class="n">LombScargle</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">lc</span><span class="o">.</span><span class="n">flux</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
                             <span class="n">nterms</span><span class="o">=</span><span class="n">nterms</span><span class="p">,</span> <span class="n">normalization</span><span class="o">=</span><span class="s1">&#39;psd&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">power</span> <span class="o">=</span> <span class="n">LS</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">frequency</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">LS</span> <span class="o">=</span> <span class="n">LombScargle</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">lc</span><span class="o">.</span><span class="n">flux</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
                             <span class="n">nterms</span><span class="o">=</span><span class="n">nterms</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">power</span> <span class="o">=</span> <span class="n">LS</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">frequency</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">normalization</span><span class="o">=</span><span class="s1">&#39;psd&#39;</span><span class="p">)</span>

        <span class="c1"># Normalise the according to Parseval&#39;s theorem</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">lc</span><span class="o">.</span><span class="n">flux</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">power</span><span class="p">)</span>
        <span class="n">power</span> <span class="o">*=</span> <span class="n">norm</span>

        <span class="n">power</span> <span class="o">=</span> <span class="n">power</span> <span class="o">*</span> <span class="p">(</span><span class="n">cds</span><span class="o">.</span><span class="n">ppm</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Rescale power to units of ppm^2 / [frequency unit]</span>
        <span class="n">power</span> <span class="o">=</span> <span class="n">power</span> <span class="o">/</span> <span class="n">fs</span>

        <span class="c1"># Periodogram needs properties</span>
        <span class="k">return</span> <span class="n">Periodogram</span><span class="p">(</span><span class="n">frequency</span><span class="o">=</span><span class="n">frequency</span><span class="p">,</span> <span class="n">power</span><span class="o">=</span><span class="n">power</span><span class="p">,</span> <span class="n">nyquist</span><span class="o">=</span><span class="n">nyquist</span><span class="p">,</span>
                           <span class="n">targetid</span><span class="o">=</span><span class="n">lc</span><span class="o">.</span><span class="n">targetid</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">lc</span><span class="o">.</span><span class="n">label</span><span class="p">)</span></div>

<div class="viewcode-block" id="Periodogram.bin"><a class="viewcode-back" href="../../api/lightkurve.periodogram.Periodogram.html#lightkurve.periodogram.Periodogram.bin">[docs]</a>    <span class="k">def</span> <span class="nf">bin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">binsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Bins the power spectrum.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        binsize : int</span>
<span class="sd">            The factor by which to bin the power spectrum, in the sense that</span>
<span class="sd">            the power spectrum will be smoothed by taking the mean in bins</span>
<span class="sd">            of size N / binsize, where N is the length of the original</span>
<span class="sd">            frequency array. Defaults to 10.</span>
<span class="sd">        method : str, one of &#39;mean&#39; or &#39;median&#39;</span>
<span class="sd">            Method to use for binning. Default is &#39;mean&#39;.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        binned_periodogram : a `Periodogram` object</span>
<span class="sd">            Returns a new `Periodogram` object which has been binned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Input validation</span>
        <span class="k">if</span> <span class="n">binsize</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;binsize must be larger than or equal to 1&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;median&#39;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> is not a valid method, must be &#39;mean&#39; or &#39;median&#39;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">method</span><span class="p">))</span>

        <span class="n">m</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="p">)</span> <span class="o">/</span> <span class="n">binsize</span><span class="p">)</span>  <span class="c1"># length of the binned arrays</span>
        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;mean&#39;</span><span class="p">:</span>
            <span class="n">binned_freq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequency</span><span class="p">[:</span><span class="n">m</span><span class="o">*</span><span class="n">binsize</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">m</span><span class="p">,</span> <span class="n">binsize</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">binned_power</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="p">[:</span><span class="n">m</span><span class="o">*</span><span class="n">binsize</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">m</span><span class="p">,</span> <span class="n">binsize</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;median&#39;</span><span class="p">:</span>
            <span class="n">binned_freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmedian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequency</span><span class="p">[:</span><span class="n">m</span><span class="o">*</span><span class="n">binsize</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">m</span><span class="p">,</span> <span class="n">binsize</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">binned_power</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmedian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="p">[:</span><span class="n">m</span><span class="o">*</span><span class="n">binsize</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">m</span><span class="p">,</span> <span class="n">binsize</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">binned_pg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">binned_pg</span><span class="o">.</span><span class="n">frequency</span> <span class="o">=</span> <span class="n">binned_freq</span>
        <span class="n">binned_pg</span><span class="o">.</span><span class="n">power</span> <span class="o">=</span> <span class="n">binned_power</span>
        <span class="k">return</span> <span class="n">binned_pg</span></div>

<div class="viewcode-block" id="Periodogram.smooth"><a class="viewcode-back" href="../../api/lightkurve.periodogram.Periodogram.html#lightkurve.periodogram.Periodogram.smooth">[docs]</a>    <span class="k">def</span> <span class="nf">smooth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;boxkernel&#39;</span><span class="p">,</span> <span class="n">filter_width</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Smooths the power spectrum using the &#39;boxkernel&#39; or &#39;logmedian&#39; method.</span>

<span class="sd">        If `method` is set to &#39;boxkernel&#39;, this method will smooth the power</span>
<span class="sd">        spectrum by convolving with a numpy Box1DKernel with a width of</span>
<span class="sd">        `filter_width`, where `filter width` is in units of frequency.</span>
<span class="sd">        This is best for filtering out noise while maintaining seismic mode</span>
<span class="sd">        peaks. This method requires the Periodogram to have an evenly spaced</span>
<span class="sd">        grid of frequencies. A `ValueError` exception will be raised if this is</span>
<span class="sd">        not the case.</span>

<span class="sd">        If `method` is set to &#39;logmedian&#39;, it smooths the power spectrum using</span>
<span class="sd">        a moving median which moves across the power spectrum in a steps of</span>

<span class="sd">        log10(x0) + 0.5 * filter_width</span>

<span class="sd">        where `filter width` is in log10(frequency) space. This is best for</span>
<span class="sd">        estimating the noise background, as it filters over the seismic peaks.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        method : str, one of &#39;boxkernel&#39; or &#39;logmedian&#39;</span>
<span class="sd">            The smoothing method to use. Defaults to &#39;boxkernel&#39;.</span>
<span class="sd">        filter_width : float</span>
<span class="sd">            If `method` = &#39;boxkernel&#39;, this is the width of the smoothing filter</span>
<span class="sd">            in units of frequency.</span>
<span class="sd">            If method = `logmedian`, this is the width of the smoothing filter</span>
<span class="sd">            in log10(frequency) space.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        smoothed_pg : `Periodogram` object</span>
<span class="sd">            Returns a new `Periodogram` object in which the power spectrum</span>
<span class="sd">            has been smoothed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Input validation</span>
        <span class="k">if</span> <span class="n">method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;boxkernel&#39;</span><span class="p">,</span> <span class="s1">&#39;logmedian&#39;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;the `method` parameter must be one of &quot;</span>
                             <span class="s2">&quot;&#39;boxkernel&#39; or &#39;logmedian&#39;.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;boxkernel&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">filter_width</span> <span class="o">&lt;=</span> <span class="mf">0.</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;the `filter_width` parameter must be &quot;</span>
                                 <span class="s2">&quot;larger than 0 for the &#39;boxkernel&#39; method.&quot;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">filter_width</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">filter_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequency</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">u</span><span class="o">.</span><span class="n">UnitConversionError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;the `filter_width` parameter must have &quot;</span>
                                 <span class="s2">&quot;frequency units.&quot;</span><span class="p">)</span>

            <span class="c1"># Check to see if we have a grid of evenly spaced periods instead.</span>
            <span class="n">fs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequency</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequency</span><span class="o">.</span><span class="n">value</span><span class="p">)),</span> <span class="n">fs</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;the &#39;boxkernel&#39; method requires the periodogram &quot;</span>
                                 <span class="s2">&quot;to have a grid of evenly spaced frequencies.&quot;</span><span class="p">)</span>

            <span class="n">box_kernel</span> <span class="o">=</span> <span class="n">Box1DKernel</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">filter_width</span><span class="o">/</span><span class="n">fs</span><span class="p">))</span>
            <span class="n">smooth_power</span> <span class="o">=</span> <span class="n">convolve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">box_kernel</span><span class="p">)</span>
            <span class="n">smooth_pg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">smooth_pg</span><span class="o">.</span><span class="n">power</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">smooth_power</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">smooth_pg</span>

        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;logmedian&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filter_width</span><span class="p">,</span> <span class="n">astropy</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">Quantity</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;the &#39;logmedian&#39; method requires a dimensionless &quot;</span>
                                 <span class="s2">&quot;value for `filter_width` in log10(frequency) space.&quot;</span><span class="p">)</span>
            <span class="n">count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequency</span><span class="o">.</span><span class="n">value</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">bkg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequency</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequency</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">while</span> <span class="n">x0</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequency</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
                <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequency</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">filter_width</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bkg</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">bkg</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmedian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                    <span class="n">count</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">x0</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">filter_width</span>
            <span class="n">bkg</span> <span class="o">/=</span> <span class="n">count</span>
            <span class="n">smooth_pg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">smooth_pg</span><span class="o">.</span><span class="n">power</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">bkg</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">smooth_pg</span></div>

<div class="viewcode-block" id="Periodogram.plot"><a class="viewcode-back" href="../../api/lightkurve.periodogram.Periodogram.html#lightkurve.periodogram.Periodogram.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
             <span class="n">style</span><span class="o">=</span><span class="s1">&#39;lightkurve&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;frequency&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plots the Periodogram.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        scale: str</span>
<span class="sd">            Set x,y axis to be &quot;linear&quot; or &quot;log&quot;. Default is linear.</span>
<span class="sd">        ax : matplotlib.axes._subplots.AxesSubplot</span>
<span class="sd">            A matplotlib axes object to plot into. If no axes is provided,</span>
<span class="sd">            a new one will be generated.</span>
<span class="sd">        xlabel : str</span>
<span class="sd">            Plot x axis label</span>
<span class="sd">        ylabel : str</span>
<span class="sd">            Plot y axis label</span>
<span class="sd">        title : str</span>
<span class="sd">            Plot set_title</span>
<span class="sd">        style : str</span>
<span class="sd">            Path or URL to a matplotlib style file, or name of one of</span>
<span class="sd">            matplotlib&#39;s built-in stylesheets (e.g. &#39;ggplot&#39;).</span>
<span class="sd">            Lightkurve&#39;s custom stylesheet is used by default.</span>
<span class="sd">        format : str</span>
<span class="sd">            {&#39;frequency&#39;, &#39;period&#39;}. Default &#39;frequency&#39;. If &#39;frequency&#39;, x-axis</span>
<span class="sd">            units will be frequency. If &#39;period&#39;, the x-axis units will be</span>
<span class="sd">            period and &#39;log&#39; scale.</span>
<span class="sd">        kwargs : dict</span>
<span class="sd">            Dictionary of arguments to be passed to `matplotlib.pyplot.plot`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ax : matplotlib.axes._subplots.AxesSubplot</span>
<span class="sd">            The matplotlib axes object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">Quantity</span><span class="p">):</span>
            <span class="n">unit</span> <span class="o">=</span> <span class="n">unit</span><span class="o">.</span><span class="n">unit</span>

        <span class="k">if</span> <span class="n">unit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequency</span><span class="o">.</span><span class="n">unit</span>
            <span class="k">if</span> <span class="nb">format</span> <span class="o">==</span> <span class="s1">&#39;period&#39;</span><span class="p">:</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">period</span><span class="o">.</span><span class="n">unit</span>

        <span class="k">if</span> <span class="n">style</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;lightkurve&#39;</span><span class="p">:</span>
            <span class="n">style</span> <span class="o">=</span> <span class="n">MPLSTYLE</span>
        <span class="k">if</span> <span class="n">ylabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ylabel</span> <span class="o">=</span> <span class="s2">&quot;Power Spectral Density [</span><span class="si">{}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="s1">&#39;latex&#39;</span><span class="p">))</span>

        <span class="c1"># This will need to be fixed with housekeeping. Self.label currently doesnt exist.</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;label&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;label&#39;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span>

        <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="n">style</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

            <span class="c1"># Plot frequency and power</span>
            <span class="k">if</span> <span class="nb">format</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;frequency&#39;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequency</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">unit</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">xlabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">xlabel</span> <span class="o">=</span> <span class="s2">&quot;Frequency [</span><span class="si">{}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">unit</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="s1">&#39;latex&#39;</span><span class="p">))</span>
            <span class="k">elif</span> <span class="nb">format</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;period&#39;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">period</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">unit</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">xlabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">xlabel</span> <span class="o">=</span> <span class="s2">&quot;Period [</span><span class="si">{}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">unit</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="s1">&#39;latex&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> is not a valid plotting format&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">format</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
            <span class="c1"># Show the legend if labels were set</span>
            <span class="n">legend_labels</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">legend_labels</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="Periodogram.flatten"><a class="viewcode-back" href="../../api/lightkurve.periodogram.Periodogram.html#lightkurve.periodogram.Periodogram.flatten">[docs]</a>    <span class="k">def</span> <span class="nf">flatten</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;logmedian&#39;</span><span class="p">,</span> <span class="n">filter_width</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">return_trend</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Estimates the Signal-To-Noise (SNR) spectrum by dividing out an</span>
<span class="sd">        estimate of the noise background.</span>

<span class="sd">        This method divides the power spectrum by a background estimated</span>
<span class="sd">        using a moving filter in log10 space by default. For details on the</span>
<span class="sd">        `method` and `filter_width` parameters, see `Periodogram.smooth()`</span>

<span class="sd">        Dividing the power through by the noise background produces a spectrum</span>
<span class="sd">        with no units of power. Since the signal is divided through by a measure</span>
<span class="sd">        of the noise, we refer to this as a `Signal-To-Noise` spectrum.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        method : str, one of &#39;boxkernel&#39; or &#39;logmedian&#39;</span>
<span class="sd">            Background estimation method passed on to `Periodogram.smooth()`.</span>
<span class="sd">            Defaults to &#39;logmedian&#39;.</span>
<span class="sd">        filter_width : float</span>
<span class="sd">            If `method` = &#39;boxkernel&#39;, this is the width of the smoothing filter</span>
<span class="sd">            in units of frequency.</span>
<span class="sd">            If method = `logmedian`, this is the width of the smoothing filter</span>
<span class="sd">            in log10(frequency) space.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        snr_spectrum : `Periodogram` object</span>
<span class="sd">            Returns a periodogram object where the power is an estimate of the</span>
<span class="sd">            signal-to-noise of the spectrum, creating by dividing the powers</span>
<span class="sd">            with a simple estimate of the noise background using a smoothing filter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bkg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">smooth</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">filter_width</span><span class="o">=</span><span class="n">filter_width</span><span class="p">)</span>
        <span class="n">snr_pg</span> <span class="o">=</span> <span class="bp">self</span> <span class="o">/</span> <span class="n">bkg</span><span class="o">.</span><span class="n">power</span>
        <span class="n">snr</span> <span class="o">=</span> <span class="n">SNRPeriodogram</span><span class="p">(</span><span class="n">snr_pg</span><span class="o">.</span><span class="n">frequency</span><span class="p">,</span> <span class="n">snr_pg</span><span class="o">.</span><span class="n">power</span><span class="p">,</span>
                             <span class="n">nyquist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nyquist</span><span class="p">,</span> <span class="n">targetid</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">targetid</span><span class="p">,</span>
                             <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">meta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">return_trend</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">snr</span><span class="p">,</span> <span class="n">bkg</span>
        <span class="k">return</span> <span class="n">snr</span></div>

<div class="viewcode-block" id="Periodogram.to_table"><a class="viewcode-back" href="../../api/lightkurve.periodogram.Periodogram.html#lightkurve.periodogram.Periodogram.to_table">[docs]</a>    <span class="k">def</span> <span class="nf">to_table</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Exports the Periodogram as an Astropy Table.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        table : `astropy.table.Table` object</span>
<span class="sd">            An AstroPy Table with columns &#39;frequency&#39;, &#39;period&#39;, and &#39;power&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequency</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">period</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="p">),</span>
                     <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;frequency&#39;</span><span class="p">,</span> <span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="s1">&#39;power&#39;</span><span class="p">),</span>
                     <span class="n">meta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">)</span></div>

<div class="viewcode-block" id="Periodogram.copy"><a class="viewcode-back" href="../../api/lightkurve.periodogram.Periodogram.html#lightkurve.periodogram.Periodogram.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a copy of the Periodogram object.</span>

<span class="sd">        This method uses the `copy.deepcopy` function to ensure that all</span>
<span class="sd">        objects stored within the Periodogram are copied.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pg_copy : Periodogram</span>
<span class="sd">            A new `Periodogram` object which is a copy of the original.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span><span class="p">(</span><span class="s1">&#39;Periodogram(ID: </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">targetid</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="n">copy_self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">copy_self</span><span class="o">.</span><span class="n">frequency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequency</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="n">copy_self</span><span class="o">.</span><span class="n">power</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">copy_self</span>

    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">copy_self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">copy_self</span><span class="o">.</span><span class="n">power</span> <span class="o">=</span> <span class="n">copy_self</span><span class="o">.</span><span class="n">power</span> <span class="o">+</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">copy_self</span>

    <span class="k">def</span> <span class="nf">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="o">-</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">copy_self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">copy_self</span><span class="o">.</span><span class="n">power</span> <span class="o">=</span> <span class="n">other</span> <span class="o">-</span> <span class="n">copy_self</span><span class="o">.</span><span class="n">power</span>
        <span class="k">return</span> <span class="n">copy_self</span>

    <span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">copy_self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">copy_self</span><span class="o">.</span><span class="n">power</span> <span class="o">=</span> <span class="n">other</span> <span class="o">*</span> <span class="n">copy_self</span><span class="o">.</span><span class="n">power</span>
        <span class="k">return</span> <span class="n">copy_self</span>

    <span class="k">def</span> <span class="nf">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__mul__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__mul__</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__rtruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">copy_self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">copy_self</span><span class="o">.</span><span class="n">power</span> <span class="o">=</span> <span class="n">other</span> <span class="o">/</span> <span class="n">copy_self</span><span class="o">.</span><span class="n">power</span>
        <span class="k">return</span> <span class="n">copy_self</span>

    <span class="k">def</span> <span class="nf">__div__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__truediv__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__rdiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__rtruediv__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

<div class="viewcode-block" id="Periodogram.properties"><a class="viewcode-back" href="../../api/lightkurve.periodogram.Periodogram.html#lightkurve.periodogram.Periodogram.properties">[docs]</a>    <span class="k">def</span> <span class="nf">properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Prints a summary of the non-callable attributes of the Periodogram object.</span>

<span class="sd">        Prints in order of type (ints, strings, lists, arrays and others).</span>
<span class="sd">        Prints in alphabetical order.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">attrs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">attr</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">):</span>
                <span class="n">res</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">res</span><span class="p">):</span>
                    <span class="k">continue</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">astropy</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">Quantity</span><span class="p">):</span>
                    <span class="n">unit</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">unit</span>
                    <span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">value</span>
                    <span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;res&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">}</span>
                    <span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="s1">&#39;unit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">unit</span><span class="o">.</span><span class="n">to_string</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;res&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">}</span>
                    <span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="s1">&#39;unit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

                <span class="k">if</span> <span class="n">attr</span> <span class="o">==</span> <span class="s1">&#39;hdu&#39;</span><span class="p">:</span>
                    <span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;res&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;list&#39;</span><span class="p">}</span>
                    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="s1">&#39;print&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;EXTNAME&#39;</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="s1">&#39;print&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                <span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="s1">&#39;print&#39;</span><span class="p">],</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;EXTNAME&#39;</span><span class="p">]))</span>
                    <span class="k">continue</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                    <span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="s1">&#39;print&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
                    <span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;int&#39;</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
                    <span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="s1">&#39;print&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
                    <span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;float&#39;</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                    <span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="s1">&#39;print&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;array </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                    <span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;array&#39;</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="s1">&#39;print&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;list length </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>
                    <span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;list&#39;</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">res</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                        <span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="s1">&#39;print&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="s1">&#39;print&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
                    <span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;str&#39;</span>
                <span class="k">elif</span> <span class="n">attr</span> <span class="o">==</span> <span class="s1">&#39;wcs&#39;</span><span class="p">:</span>
                    <span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="s1">&#39;print&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;astropy.wcs.wcs.WCS&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
                    <span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;other&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="s1">&#39;print&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>
                    <span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;other&#39;</span>

        <span class="n">output</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Attribute&#39;</span><span class="p">,</span> <span class="s1">&#39;Description&#39;</span><span class="p">,</span> <span class="s1">&#39;Units&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="p">[</span><span class="nb">object</span><span class="p">,</span> <span class="nb">object</span><span class="p">,</span> <span class="nb">object</span><span class="p">])</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">types</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="s1">&#39;array&#39;</span><span class="p">,</span> <span class="s1">&#39;other&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">typ</span> <span class="ow">in</span> <span class="n">types</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">attr</span><span class="p">,</span> <span class="n">dic</span> <span class="ow">in</span> <span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">dic</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">typ</span><span class="p">:</span>
                    <span class="n">output</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="n">attr</span><span class="p">,</span> <span class="n">dic</span><span class="p">[</span><span class="s1">&#39;print&#39;</span><span class="p">],</span> <span class="n">dic</span><span class="p">[</span><span class="s1">&#39;unit&#39;</span><span class="p">]])</span>
                    <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lightkurve.Periodogram properties:&#39;</span><span class="p">)</span>
        <span class="n">output</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">max_lines</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_width</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></div></div>


<span class="k">class</span> <span class="nc">SNRPeriodogram</span><span class="p">(</span><span class="n">Periodogram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Defines a Signal-to-Noise Ratio (SNR) Periodogram class.</span>

<span class="sd">    This class is nearly identical to the standard :class:`Periodogram` class,</span>
<span class="sd">    but has different plotting defaults.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SNRPeriodogram</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span><span class="p">(</span><span class="s1">&#39;SNRPeriodogram(ID: </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">targetid</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot the SNR spectrum using matplotlib&#39;s `plot` method.</span>
<span class="sd">        See `Periodogram.plot` for details on the accepted arguments.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        kwargs : dict</span>
<span class="sd">            Dictionary of arguments ot be passed to `Periodogram.plot`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ax : matplotlib.axes._subplots.AxesSubplot</span>
<span class="sd">            The matplotlib axes object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">SNRPeriodogram</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;ylabel&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Signal to Noise Ratio (SNR)&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ax</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright lightkurve developers and contributors.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0b21',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>